<!doctype html><html lang='en'><head>
<meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/>
<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 64 64%22><circle cx=%2222%22 cy=%2242%22 r=%228%22 fill=%22%2386efac%22/></svg>"/>
<style>
:root{--bg:#f6f7f4;--panel:#fff;--text:#0f172a;--muted:#64748b;--border:#e2e8f0;--brand:#0ea5e9;--accent:#16a34a;--shadow:0 10px 24px rgba(2,6,23,.08)}
*{box-sizing:border-box}html,body{margin:0;padding:0;background:var(--bg);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,sans-serif}
.header{position:sticky;top:0;background:rgba(255,255,255,.9);backdrop-filter:saturate(160%) blur(8px);border-bottom:1px solid var(--border);padding:16px}
.wrap{max-width:1100px;margin:0 auto;padding:0 16px;display:flex;align-items:center;justify-content:space-between}
.brand{display:flex;gap:10px;align-items:center;font-weight:800}
.nav a{color:var(--brand);text-decoration:none;margin-left:12px}
.hero{max-width:1100px;margin:28px auto 0;padding:0 16px}
.card{background:rgba(255,255,255,.9);border:1px solid var(--border);border-radius:16px;box-shadow:var(--shadow);padding:24px}
.cta{background:var(--accent);color:#fff;border:none;border-radius:12px;padding:12px 16px;font-weight:800;cursor:pointer}
.footer{max-width:1100px;margin:0 auto;padding:24px 16px;color:var(--muted);text-align:center;border-top:1px solid var(--border)}
.footer a{color:#0369a1;text-decoration:none;margin:0 6px}
.section{max-width:1100px;margin:20px auto;padding:0 16px}
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:12px}
.card2{background:rgba(255,255,255,.9);border:1px solid var(--border);border-radius:14px;box-shadow:var(--shadow);padding:16px}
.badge{display:inline-block;background:#ecfdf5;color:#065f46;border:1px solid #a7f3d0;border-radius:999px;padding:6px 10px;font-size:12px;font-weight:800}
input,select{border:1px solid var(--border);border-radius:10px;padding:10px 12px}
.btn{background:#0ea5e9;color:#fff;border:none;border-radius:10px;padding:10px 12px;font-weight:800;cursor:pointer}
.btn.secondary{background:#1118271a;color:#0f172a}
.map{height:360px;background:linear-gradient(180deg,#c8e6c9,#a5d6a7);border-radius:14px;border:1px solid var(--border);box-shadow:var(--shadow)}
html, body { min-height: 100%; }
body {
  background-image: url('/assets/hero_golf_bg.jpg');
  background-size: cover;
  background-position: center 40%;
  background-attachment: fixed;
  background-repeat: no-repeat;
}
</style>
<script src='/assets/providers.js'></script><script src='/assets/config.js'></script><title>TeeRadar — Search</title></head><body>
<header class="header">
  <div class="wrap">
    <div class="brand">
      <svg width="28" height="28" viewBox="0 0 64 64"><circle cx="22" cy="42" r="8" fill="#86efac"/><rect x="40" y="24" width="4" height="24" fill="#94a3b8"/><path d="M44 24 L60 18 L44 12 Z" fill="#0ea5e9"/></svg>
      <span>TeeRadar</span>
    </div>
    <nav class="nav"><a href="/">Home</a><a href="/book.html">Book</a><a href="/dashboard.html">Dashboard</a><a href="/faq.html">FAQ</a></nav>
  </div>
</header>

<section class='section'>
  <div class='card2' style='display:grid;grid-template-columns:1fr 1fr 1fr 1fr 1fr;gap:10px;align-items:end'>
    <div><label>Date<br><input type='date' id='date'></label></div>
    <div><label>Start<br><input type='time' id='timeStart' value='06:00'></label></div>
    <div><label>End<br><input type='time' id='timeEnd' value='17:00'></label></div>
    <div><label>Holes<br><select id='holes'><option value=''>Any</option><option>9</option><option>18</option></select></label></div>
    <div><label>Players<br><select id='party'><option>1</option><option>2</option><option>3</option><option selected>4</option></select></label></div>
    <div style='grid-column:1/-1;display:flex;gap:10px'><input id='q' placeholder='Search suburb/course…' style='flex:1'><button class='btn' id='btnSearch'>Search</button></div>
  </div>
</section>
<section class='section'><div class='map' id='map'>Map preview</div></section>
<section class='section'><div id='results' class='grid'></div></section>

<footer class="footer">
  © <script>document.write(new Date().getFullYear())</script> TeeRadar
  • <a href="/faq.html">FAQ</a>
  • <a href="/terms.html">Terms of Use</a>
  • <a href="/privacy.html">Privacy</a>
  • <a href="/refunds.html">Refunds & Cancellations</a>
</footer>

<script>
let COURSE_CONFIG_MAP = {}, COURSE_LINKS = {}, isMember = localStorage.getItem('teeradar_member')==='1';
fetch('/assets/course_config.json').then(r=>r.json()).then(j=>COURSE_CONFIG_MAP=j);
fetch('/assets/course_links.json').then(r=>r.json()).then(j=>COURSE_LINKS=j);
function officialUrlOrSearch(name){ return COURSE_LINKS[name] || ('https://www.google.com/search?q='+encodeURIComponent(name+' golf booking')); }
function openCourseForMembers(url){ if(!isMember){ alert('Members only. Subscribe to unlock direct booking links.'); return; } window.open(url,'_blank','noopener,noreferrer'); }
function courseCard(it){
  var html = '';
  html += "<div class='card2'>";
  html += "<div class='badge'>" + (it.provider||'Course') + "</div>";
  html += "<h3 style='margin:8px 0 4px 0'>" + it.name + "</h3>";
  html += "<div style='color:var(--muted);font-size:14px'>" + (it.city||'') + " " + (it.state||'') + "</div>";
  html += "<div class='price' style='font-weight:800;margin:8px 0'>$" + (it.price||49).toFixed(2) + " AUD</div>";
  html += "<div style='display:flex;gap:8px'>";
  html += "<button class='btn secondary' onclick=\"openCourseForMembers(officialUrlOrSearch('"+'__NAME__'+"'))\">Book on course site</button>".replace('__NAME__', it.name.replace(/"/g,'\"'));
  html += "<button class='btn' onclick=\"(function(){ var d=document.getElementById('date').value||''; var u=TeeRadarProviders.proceedUrl('"+'__NAME2__'+"', d, it.time, COURSE_CONFIG_MAP, officialUrlOrSearch); openCourseForMembers(u); })()\">Proceed to booking</button>".replace('__NAME2__', it.name.replace(/"/g,'\"'));
  html += "</div></div>";
  return html;
}
function render(list){ document.getElementById('results').innerHTML = list.map(courseCard).join(''); }
const demoData=[
  {name:'Araluen Estate', provider:'MiClub', city:'Roleystone', state:'WA', postcode:'6111', date:'2025-11-01', time:'07:00', holes:18, spots:4, price:65},
  {name:'Wembley Golf Course (Old & Tuart)', provider:'MiClub', city:'Wembley Downs', state:'WA', postcode:'6019', date:'2025-11-01', time:'09:15', holes:9, spots:2, price:52}
];
function runDemoSearch(){
  const date=document.getElementById('date').value;
  const s=document.getElementById('timeStart').value, e=document.getElementById('timeEnd').value;
  const holes=document.getElementById('holes').value; const party=parseInt(document.getElementById('party').value||'0',10);
  const q=(document.getElementById('q').value||'').toLowerCase();
  const out=demoData.filter(function(it){
    const inQ=!q||(it.name+' '+(it.city||'')+' '+(it.state||'')+' '+(it.postcode||'')).toLowerCase().includes(q);
    const inDate=!date||it.date===date;
    const inHoles=!holes||String(it.holes)===holes;
    const inTime=(!s||it.time>=s)&&(!e||it.time<=e);
    const inParty=!party||it.spots>=party;
    return inQ&&inDate&&inHoles&&inTime&&inParty;
  });
  render(out);
}
async function runLiveSearch(){
  const base = window.TEERADAR_BACKEND || '';
  const body = {
    date: document.getElementById('date').value || '2025-11-01',
    earliest: document.getElementById('timeStart').value || '06:00',
    latest: document.getElementById('timeEnd').value || '17:00',
    holes: document.getElementById('holes').value || null,
    partySize: parseInt(document.getElementById('party').value||'0',10) || 1
  };
  const r = await fetch((base||'') + '/api/search', { method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify(body) });
  const j = await r.json();
  const list = (j.slots||[]).map(function(s){
    return { name: s.name, provider: s.provider, city:'', state:'', time: s.time, holes: s.holes, spots: s.spots, price: s.price };
  });
  render(list);
}
document.getElementById('btnSearch').addEventListener('click', async function(){
  try { await runLiveSearch(); }
  catch(e){ console.warn('Live search failed, falling back to demo', e); runDemoSearch(); }
});
</script>
</body></html>
