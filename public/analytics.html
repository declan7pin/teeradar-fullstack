<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>TeeRadar WA â€” Analytics</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    /* ... your same CSS unchanged ... */
  </style>
</head>

<body>
<header>
  <div class="nav-wrap">
    <div class="brand">
      <div class="brand-logo">T</div>
      <div class="brand-text">TeeRadar&nbsp;WA</div>
    </div>
    <nav>
      <a href="/index.html">Home</a>
      <a href="/book.html">Bookings</a>
      <a href="/faq.html">FAQ</a>
      <a href="/about.html">About</a>
      <a href="/analytics.html" class="nav-analytics">Analytics</a>
    </nav>
  </div>
</header>

<main>
  <!-- same HTML as your existing layout -->
</main>

<script>
  // ðŸ”¥ NEW â€” correct summary fetcher (matches your backend)
  async function fetchAnalyticsSummary() {
    try {
      const res = await fetch("/api/analytics", {
        headers: { "Accept": "application/json" }
      });
      if (!res.ok) return null;
      const data = await res.json();
      console.log("[analytics] summary:", data);
      return data;
    } catch (err) {
      console.error("analytics summary error", err);
      return null;
    }
  }

  async function loadAnalytics() {
    const summary = await fetchAnalyticsSummary();

    if (!summary) {
      document.getElementById("summaryUpdated").textContent =
        "Analytics backend not configured.";
      return;
    }

    // ðŸ”¥ Map values
    document.getElementById("metricHomeViews").textContent =
      summary.homePageViews ?? summary.homeViews ?? 0;

    document.getElementById("metricBookingClicks").textContent =
      summary.courseBookingClicks ?? summary.bookingClicks ?? 0;

    document.getElementById("metricSearches").textContent =
      summary.searches ?? 0;

    document.getElementById("metricNewUsers").textContent =
      summary.newUsers ?? 0;

    document.getElementById("usersAllTime").textContent =
      summary.usersAllTime ?? 0;

    document.getElementById("usersToday").textContent =
      summary.usersToday ?? 0;

    document.getElementById("usersWeek").textContent =
      summary.usersWeek ?? 0;

    // ðŸ”¥ Top courses
    const topList = document.getElementById("topCoursesList");
    topList.innerHTML = "";

    const top = summary.topCourses || [];

    if (top.length === 0) {
      topList.innerHTML =
        `<li><span class="label">No course clicks yet</span><span class="value">â€”</span></li>`;
    } else {
      top.forEach((c) => {
        topList.innerHTML += `
          <li>
            <span class="label">${c.courseName}</span>
            <span class="value">${c.clicks} clicks</span>
          </li>`;
      });
    }

    document.getElementById("summaryUpdated").textContent =
      "Last updated " + new Date().toLocaleString();
  }

  window.addEventListener("load", loadAnalytics);
</script>
</body>
</html>