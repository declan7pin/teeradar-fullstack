<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>TeeRadar WA — Find a Tee Time Across WA</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="icon" type="image/png" href="/assets/icon-192.png" />

  <style>
    :root {
      --teal: #00796b;
      --teal-dark: #005e55;
      --bg: #f4f7fb;
      --card: #ffffff;
      --text: #0f172a;
      --muted: #64748b;
      --border: #e2e8f0;
      --accent: #0ea5e9;
      --pill: #ecfeff;
    }

    * { box-sizing: border-box; }

    html, body {
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #e0f2f1, #f9fafb);
      color: var(--text);
    }

    a { text-decoration: none; color: inherit; }
    button { font-family: inherit; }

    /* ------------------ HEADER ------------------ */
    header {
      background: var(--teal);
      color: #fff;
      padding: 10px 4vw;
      position: sticky;
      top: 0;
      z-index: 20;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.12);
    }

    .nav-wrap {
      max-width: 1100px;
      margin: 0 auto;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 16px;
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .brand-logo {
      width: 26px;
      height: 26px;
      border-radius: 999px;
      background: #ecfdf5;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #065f46;
      font-size: 15px;
      font-weight: 800;
      box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.25);
    }

    .brand-text {
      font-weight: 700;
      letter-spacing: .04em;
      font-size: 15px;
    }

    nav {
      display: flex;
      gap: 16px;
      align-items: center;
      flex-wrap: wrap;
      justify-content: flex-end;
      font-size: 13px;
    }

    nav a {
      color: #e0f2f1;
      opacity: .88;
      padding: 4px 6px;
      border-radius: 999px;
    }

    nav a:hover {
      background: rgba(255,255,255,0.16);
      opacity: 1;
    }

    .nav-login, .nav-account {
      background: #ffffff;
      color: var(--teal-dark);
      border: none;
      padding: 6px 14px;
      border-radius: 999px;
      font-size: 12px;
      font-weight: 600;
      cursor: pointer;
    }

    .nav-analytics {
      background: rgba(15,118,110,0.18);
      border: 1px solid rgba(45,212,191,0.6);
      padding: 4px 10px;
      font-weight: 600;
    }

    /* ------------------ HERO ------------------ */
    main {
      max-width: 1100px;
      margin: 28px auto 40px;
      padding: 0 4vw 50px;
    }

    .hero {
      display: grid;
      grid-template-columns: 1.1fr 1fr;
      gap: 24px;
      align-items: center;
    }

    @media(max-width:880px) {
      .hero { grid-template-columns: 1fr; }
    }

    .hero-kicker {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 12px;
      color: var(--muted);
      margin-bottom: 10px;
    }

    .hero-kicker-pill {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 3px 9px;
      border-radius: 999px;
      background: #ecfeff;
      border: 1px solid #bae6fd;
      font-weight: 600;
      color: #0369a1;
    }

    .hero-title {
      font-size: clamp(28px, 4vw, 36px);
      font-weight: 800;
      letter-spacing: -0.02em;
      margin: 0 0 10px;
    }

    .hero-sub {
      font-size: 14px;
      color: var(--muted);
      max-width: 480px;
      margin-bottom: 18px;
    }

    .hero-actions {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 14px;
    }

    .btn-primary {
      background: var(--teal);
      color: #fff;
      border: none;
      border-radius: 999px;
      padding: 10px 20px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      box-shadow: 0 14px 28px rgba(15,118,110,0.28);
    }

    .btn-outline {
      background: #ecfeff;
      color: #0369a1;
      border: none;
      border-radius: 999px;
      padding: 9px 16px;
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
    }

  </style>
</head>

<body>
<header>
  <div class="nav-wrap">

    <div class="brand">
      <div class="brand-logo">T</div>
      <div class="brand-text">TeeRadar WA</div>
    </div>

    <nav>
      <a href="/index.html">Home</a>
      <a href="/book.html">Bookings</a>
      <a href="/faq.html">FAQ</a>
      <a href="/about.html">About</a>

      <!-- admin-only link -->
      <a href="/analytics.html" id="navAnalytics" class="nav-analytics" style="display:none;">Analytics</a>

      <!-- NEW: My Account -->
      <button id="navAccountBtn" class="nav-account" style="display:none;">My Account</button>

      <!-- Login -->
      <button id="navLoginBtn" class="nav-login" type="button">Log in</button>
    </nav>
  </div>
</header>

<main>
  <section class="hero">
    <div>
      <div class="hero-kicker">
        <span class="hero-kicker-pill">WA public courses</span>
        <span>Live booking links • real-time filters</span>
      </div>

      <h1 class="hero-title">Find a tee time across WA, in one place.</h1>

      <p class="hero-sub">
        Search public golf courses across Western Australia by date, time, 9/18 holes and players.
        Tap through to the official course booking page — fully compliant.
      </p>

      <div class="hero-actions">
        <button class="btn-primary" onclick="window.location.href='/book.html'">Find a tee time</button>
        <button class="btn-outline" onclick="window.location.href='/faq.html'">How TeeRadar works</button>
      </div>
    </div>
        <aside class="hero-card" aria-label="Live WA course widget">
      <div class="hero-card-bg"></div>
      <div class="hero-card-gradient"></div>

      <div class="hero-card-inner">
        <div>
          <div class="hero-card-top">
            <span class="hero-card-badge">Live WA courses</span>
            <span class="hero-card-text">Araluen • Collier • Whaleback • more</span>
          </div>
          <p style="font-size:12px;max-width:280px;margin:6px 0 0;">
            We always send you to the course’s own booking page. WA today, scalable Australia-wide.
          </p>
        </div>

        <div class="hero-card-footer">
          <span style="opacity:.85;">Course-first, compliant booking links.</span>
          <button type="button" onclick="window.location.href='/book.html'">View course links</button>
        </div>
      </div>
    </aside>
  </section>

  <!-- FEATURE CARDS -->
  <section class="features">
    <article class="feature-card">
      <h3>Single search</h3>
      <p>One simple search instead of opening a dozen course sites.</p>
    </article>
    <article class="feature-card">
      <h3>Filters that match golf</h3>
      <p>Select your date, window, holes and group size.</p>
    </article>
    <article class="feature-card">
      <h3>Course-first booking</h3>
      <p>Every booking flows through the club’s own site.</p>
    </article>
    <article class="feature-card">
      <h3>Built to scale</h3>
      <p>WA today — ready for all Australian states.</p>
    </article>
  </section>
</main>

<footer>
  <span>© 2025 TeeRadar WA — Availability depends on course systems.</span>
  <span>
    <a href="/terms.html">Terms</a> •
    <a href="/privacy.html">Privacy</a> •
    <a href="/refunds.html">Refunds</a>
  </span>
</footer>

<!-- ------------------------- LOGIN / SIGNUP MODAL ------------------------- -->
<div id="authModal" style="
  position:fixed; inset:0; background:rgba(0,0,0,0.45);
  display:none; align-items:center; justify-content:center; z-index:300;">
  <div style="background:#fff; padding:22px; border-radius:12px; width:92%; max-width:360px; position:relative;">

    <button onclick="closeAuthModal()" style="
      position:absolute; right:10px; top:10px;
      background:none; border:none; font-size:18px; cursor:pointer;">×</button>

    <h2 id="authTitle" style="margin-top:0; font-size:20px; font-weight:700;">Log in</h2>

    <label style="font-size:13px;">Email</label>
    <input id="authEmail" type="email" style="width:100%;padding:8px;margin:4px 0 10px;border:1px solid #ccc;border-radius:6px;">

    <label style="font-size:13px;">Password</label>
    <input id="authPassword" type="password" style="width:100%;padding:8px;margin:4px 0 10px;border:1px solid #ccc;border-radius:6px;">

    <!-- Home course selection (Signup only) -->
    <div id="homeCourseWrapper" style="display:none;">
      <label style="font-size:13px;">Home Course</label>
      <input id="homeCourseInput" type="text"
        placeholder="Start typing your course..."
        autocomplete="off"
        style="width:100%;padding:8px;margin:4px 0 0;border:1px solid #ccc;border-radius:6px;">

      <div id="courseSuggestions" style="
        border:1px solid #ccc; border-top:none; display:none;
        background:#fff; max-height:160px; overflow-y:auto;
        position:absolute; width:calc(100% - 44px); z-index:999;">
      </div>
    </div>

    <button id="authSubmitBtn" style="
      width:100%; background:#00796b; color:#fff; border:none;
      padding:10px; margin-top:12px; border-radius:999px; font-weight:600;
      cursor:pointer;">Continue</button>

    <p id="authSwitchText" style="text-align:center;font-size:13px;margin-top:14px;cursor:pointer;color:#00796b;">
      Need an account? Sign up
    </p>
  </div>
</div>

<script>
/* ------------------- AUTH STATE ------------------- */
let isSignupMode = false;
let coursesList = [];

/* Load course names for auto-suggest */
fetch("/api/courses")
  .then(res => res.json())
  .then(data => coursesList = data);

/* ------------------- OPEN / CLOSE MODAL ------------------- */
function openAuthModal(signup = false) {
  isSignupMode = signup;
  document.getElementById("authModal").style.display = "flex";

  document.getElementById("authTitle").textContent = signup ? "Create account" : "Log in";
  document.getElementById("authSwitchText").textContent =
    signup ? "Already have an account? Log in" : "Need an account? Sign up";

  document.getElementById("homeCourseWrapper").style.display = signup ? "block" : "none";
}

function closeAuthModal() {
  document.getElementById("authModal").style.display = "none";
}

/* Toggle login/signup */
document.getElementById("authSwitchText").onclick = () => {
  openAuthModal(!isSignupMode);
};

/* ------------------- LOGIN BUTTON IN NAV ------------------- */
document.getElementById("navLoginBtn").onclick = () => {
  openAuthModal(false);
};

/* ------------------- ACCOUNT BUTTON ------------------- */
document.getElementById("navAccountBtn").onclick = () => {
  window.location.href = "/account.html";
};

/* ------------------- ADMIN DISPLAY ------------------- */
function updateNavForUser() {
  const token = localStorage.getItem("tr_jwt");
  const email = localStorage.getItem("tr_email");

  const navLogin = document.getElementById("navLoginBtn");
  const navAcc = document.getElementById("navAccountBtn");
  const navAnalytics = document.getElementById("navAnalytics");

  if (!token) {
    navLogin.style.display = "inline-block";
    navAcc.style.display = "none";
    navAnalytics.style.display = "none";
    return;
  }

  navLogin.style.display = "none";
  navAcc.style.display = "inline-block";

  if (email === "declan7pin@gmail.com") {
    navAnalytics.style.display = "inline-flex";
  }
}
updateNavForUser();

/* ------------------- AUTO-SUGGEST LOGIC ------------------- */
const homeCourseInput = document.getElementById("homeCourseInput");
const suggestionsBox = document.getElementById("courseSuggestions");

homeCourseInput?.addEventListener("input", () => {
  const q = homeCourseInput.value.toLowerCase().trim();
  if (!q) {
    suggestionsBox.style.display = "none";
    return;
  }

  const matches = coursesList
    .filter(c => c.name.toLowerCase().includes(q))
    .slice(0, 8);

  if (matches.length === 0) {
    suggestionsBox.style.display = "none";
    return;
  }

  suggestionsBox.innerHTML = matches
    .map(c => `<div class="sugg" onclick="pickCourse('${c.name.replace(/'/g, "\\'")}')"
      style="padding:8px;cursor:pointer;border-bottom:1px solid #eee;">${c.name}</div>`)
    .join("");

  suggestionsBox.style.display = "block";
});

function pickCourse(name) {
  homeCourseInput.value = name;
  suggestionsBox.style.display = "none";
}

/* ------------------- SUBMIT LOGIN / SIGNUP ------------------- */
document.getElementById("authSubmitBtn").onclick = async () => {
  const email = document.getElementById("authEmail").value.trim();
  const password = document.getElementById("authPassword").value.trim();
  const homeCourse = document.getElementById("homeCourseInput").value.trim();

  if (!email || !password) {
    alert("Email and password required.");
    return;
  }

  if (isSignupMode && !homeCourse) {
    alert("Please select your home course.");
    return;
  }

  try {
    const endpoint = isSignupMode ? "/api/auth/signup" : "/api/auth/login";

    const res = await fetch(endpoint, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ email, password, homeCourse })
    });

    const data = await res.json();

    if (!res.ok) {
      alert(data.error || "Authentication failed");
      return;
    }

    localStorage.setItem("tr_jwt", data.token);
    localStorage.setItem("tr_email", data.email);

    if (data.homeCourse) {
      localStorage.setItem("teeradar_home_course", data.homeCourse);
    }

    closeAuthModal();
    updateNavForUser();
    alert(isSignupMode ? "Account created!" : "Logged in!");

  } catch (err) {
    console.error(err);
    alert("Server error");
  }
};
</script>

</body>
</html>