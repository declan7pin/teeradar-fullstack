<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>TeeRadar WA — Find a tee time across WA</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="icon" type="image/png" href="/assets/icon-192.png" />

  <style>
    :root {
      --teal: #00796b;
      --teal-dark: #005e55;
      --bg: #f4f7fb;
      --card: #ffffff;
      --text: #0f172a;
      --muted: #64748b;
      --border: #e2e8f0;
      --accent: #0ea5e9;
      --pill: #ecfeff;
    }
    *{box-sizing:border-box;}
    html,body{
      margin:0;
      padding:0;
      font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
      background:radial-gradient(circle at top,#e0f2f1,#f9fafb);
      color:var(--text);
    }
    a{text-decoration:none;color:inherit;}
    button{font-family:inherit;}

    /* NAV */
    header{
      background:var(--teal);
      color:#fff;
      padding:10px 4vw;
      position:sticky;
      top:0;
      z-index:20;
      box-shadow:0 2px 6px rgba(0,0,0,0.12);
    }
    .nav-wrap{
      max-width:1100px;
      margin:0 auto;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:16px;
    }
    .brand{display:flex;align-items:center;gap:10px;}
    .brand-logo{
      width:26px;height:26px;border-radius:999px;background:#ecfdf5;
      display:flex;align-items:center;justify-content:center;
      color:#065f46;font-size:15px;font-weight:800;
      box-shadow:0 0 0 3px rgba(16,185,129,0.25);
    }
    .brand-text{font-weight:700;font-size:15px;}

    nav{
      display:flex;gap:16px;align-items:center;flex-wrap:wrap;
      justify-content:flex-end;font-size:13px;
    }
    nav a{
      color:#e0f2f1;opacity:.88;padding:4px 6px;border-radius:999px;
    }
    nav a:hover{background:rgba(255,255,255,0.16);opacity:1;}

    .nav-analytics{
      background:rgba(15,118,110,0.18);
      border:1px solid rgba(45,212,191,0.6);
      padding:4px 10px;font-weight:600;
    }

    .nav-login, .nav-account{
      background:#ffffff;color:var(--teal-dark);
      border:none;padding:5px 14px;border-radius:999px;
      font-size:12px;font-weight:600;cursor:pointer;
    }

    /* ACCOUNT POPUP */
    #accountModal{
      position:fixed;top:0;left:0;width:100%;height:100%;
      background:rgba(0,0,0,0.45);
      display:none;align-items:center;justify-content:center;
      z-index:50;padding:20px;
    }
    #accountBox{
      background:#fff;padding:20px;border-radius:12px;
      max-width:380px;width:100%;box-shadow:0 4px 20px rgba(0,0,0,.2);
    }
    #accountBox h2{margin:0 0 14px;font-size:20px;}
    #accountBox label{font-size:13px;color:#444;}
    #accountBox input{
      width:100%;padding:8px;border:1px solid #ccc;
      border-radius:6px;margin-top:4px;margin-bottom:12px;
    }
    #closeAccount{float:right;cursor:pointer;font-size:14px;}

    /* AUTOSUGGEST */
    .suggest-list{
      position:absolute;
      width:100%;
      background:#fff;
      border:1px solid #ccc;
      border-radius:6px;
      margin-top:-8px;
      z-index:1000;
      display:none;
      max-height:180px;
      overflow-y:auto;
    }
    .suggest-item{
      padding:8px;cursor:pointer;font-size:14px;
    }
    .suggest-item:hover{background:#eef6f6;}

    /* HERO + FEATURES (UNCHANGED) */
    main{
      max-width:1100px;margin:28px auto 40px;padding:0 4vw 50px;
    }
    .hero{
      display:grid;grid-template-columns:1.1fr 1fr;
      gap:24px;align-items:center;
    }
    @media(max-width:880px){.hero{grid-template-columns:1fr;}}
    .hero-kicker{display:flex;align-items:center;gap:8px;font-size:12px;color:var(--muted);margin-bottom:10px;}
    .hero-kicker-pill{
      padding:3px 9px;border-radius:999px;background:#ecfeff;
      border:1px solid #bae6fd;font-weight:600;color:#0369a1;
    }
    .hero-title{font-size:clamp(28px,4vw,36px);font-weight:800;margin:0 0 10px;}
    .hero-sub{color:var(--muted);font-size:14px;max-width:480px;margin-bottom:18px;}

    .btn-primary{
      background:var(--teal);color:#fff;border:none;
      border-radius:999px;padding:10px 20px;font-size:14px;font-weight:600;
      cursor:pointer;box-shadow:0 14px 28px rgba(15,118,110,0.28);
    }
    .btn-outline{
      background:#ecfeff;color:#0369a1;border:none;
      border-radius:999px;padding:9px 16px;font-size:13px;font-weight:600;
      cursor:pointer;
    }
    .hero-chips{display:flex;flex-wrap:wrap;gap:10px;margin-top:4px;}
    .chip{
      display:inline-flex;align-items:center;gap:6px;
      padding:5px 10px;border-radius:999px;background:#fff;
      border:1px solid rgba(148,163,184,0.45);
      font-size:11px;color:var(--muted);
    }

    /* FOOTER */
    footer{max-width:1100px;margin:18px auto 32px;padding:0 4vw;font-size:11px;color:var(--muted);display:flex;justify-content:space-between;flex-wrap:wrap;gap:8px;}
  </style>
</head>

<body>

<header>
  <div class="nav-wrap">
    <div class="brand">
      <div class="brand-logo">T</div>
      <div class="brand-text">TeeRadar WA</div>
    </div>

    <nav>
      <a href="/index.html">Home</a>
      <a href="/book.html">Bookings</a>
      <a href="/faq.html">FAQ</a>
      <a href="/about.html">About</a>

      <!-- admin-only -->
      <a href="/analytics.html" id="navAnalytics" class="nav-analytics" style="display:none;">Analytics</a>

      <button id="navAccountBtn" class="nav-account" style="display:none;">My Account</button>
      <button id="navLoginBtn" class="nav-login">Log in</button>
    </nav>
  </div>
</header>

<!-- ACCOUNT POPUP -->
<div id="accountModal">
  <div id="accountBox">
    <span id="closeAccount">✕</span>
    <h2>My Account</h2>

    <label>Email</label>
    <input id="acctEmail" type="email" disabled />

    <label>Home Course</label>
    <div style="position:relative;">
      <input id="acctHomeCourse" type="text" autocomplete="off" />
      <div id="homeSuggest" class="suggest-list"></div>
    </div>

    <button onclick="saveAccount()" style="margin-top:10px;background:var(--teal);color:#fff;border:none;padding:8px 14px;border-radius:8px;font-weight:600;cursor:pointer;">
      Save
    </button>
  </div>
</div>

<main>
  <section class="hero">
    <div>
      <div class="hero-kicker">
        <span class="hero-kicker-pill">WA public courses</span>
        <span>Live booking links • real-time filters</span>
      </div>

      <h1 class="hero-title">Find a tee time across WA, in one place.</h1>
      <p class="hero-sub">
        Search public golf courses across Western Australia by date, time window, hole count and group size.
      </p>

      <div style="display:flex;gap:10px;flex-wrap:wrap;margin-bottom:12px;">
        <button class="btn-primary" onclick="location.href='/book.html'">Find a tee time</button>
        <button class="btn-outline" onclick="location.href='/faq.html'">How TeeRadar works</button>
      </div>
    </div>
  </section>
</main>

<footer>
  <span>© 2025 TeeRadar WA</span>
  <span><a href="/terms.html">Terms</a> • <a href="/privacy.html">Privacy</a></span>
</footer>

<script>
  const ADMIN_EMAIL = "declan7pin@gmail.com";
  let allCourses = [];

  // -------- LOGIN / ACCOUNT --------

  function isAdmin() {
    return localStorage.getItem("teeradar_user_email") === ADMIN_EMAIL;
  }

  function renderNavState() {
    const loginBtn = document.getElementById("navLoginBtn");
    const acctBtn = document.getElementById("navAccountBtn");
    const analyticsLink = document.getElementById("navAnalytics");

    const email = localStorage.getItem("teeradar_user_email");

    if (email) {
      loginBtn.style.display = "none";
      acctBtn.style.display = "inline-flex";
      acctBtn.textContent = "My Account";

      if (email === ADMIN_EMAIL) analyticsLink.style.display = "inline-flex";
      else analyticsLink.style.display = "none";
    } else {
      loginBtn.style.display = "inline-flex";
      acctBtn.style.display = "none";
      analyticsLink.style.display = "none";
    }
  }

  function handleLogin() {
    const email = prompt("Enter your email:");
    if (!email) return;

    const trimmed = email.trim().toLowerCase();
    localStorage.setItem("teeradar_user_email", trimmed);

    if (trimmed === ADMIN_EMAIL) alert("Admin login successful.");
    renderNavState();
  }

  document.getElementById("navLoginBtn").onclick = handleLogin;

  // OPEN ACCOUNT MODAL
  document.getElementById("navAccountBtn").onclick = () => {
    const email = localStorage.getItem("teeradar_user_email") || "";
    document.getElementById("acctEmail").value = email;

    const home = localStorage.getItem("teeradar_home_course") || "";
    document.getElementById("acctHomeCourse").value = home;

    document.getElementById("accountModal").style.display = "flex";
  };

  document.getElementById("closeAccount").onclick = () => {
    document.getElementById("accountModal").style.display = "none";
  };

  function saveAccount() {
    const val = document.getElementById("acctHomeCourse").value.trim();
    localStorage.setItem("teeradar_home_course", val);
    alert("Saved.");
    document.getElementById("accountModal").style.display = "none";
  }

  // -------- AUTOSUGGEST --------

  async function loadCourseNames() {
    const res = await fetch("/api/courses");
    const courses = await res.json();
    allCourses = courses.map(c => c.name);
  }
  loadCourseNames();

  const homeInput = document.getElementById("acctHomeCourse");
  const suggestBox = document.getElementById("homeSuggest");

  homeInput.addEventListener("input", () => {
    const q = homeInput.value.toLowerCase().trim();
    if (!q) {
      suggestBox.style.display = "none";
      return;
    }

    const matches = allCourses.filter(c => c.toLowerCase().includes(q));
    suggestBox.innerHTML = matches
      .slice(0, 10)
      .map(m => `<div class='suggest-item'>${m}</div>`)
      .join("");

    suggestBox.style.display = matches.length ? "block" : "none";
  });

  suggestBox.addEventListener("click", (evt) => {
    if (evt.target.classList.contains("suggest-item")) {
      homeInput.value = evt.target.textContent;
      suggestBox.style.display = "none";
    }
  });

  // Close suggest on outside click
  document.addEventListener("click", (evt)=>{
    if (!evt.target.closest("#acctHomeCourse") &&
        !evt.target.closest("#homeSuggest")) {
      suggestBox.style.display = "none";
    }
  });

  window.onload = renderNavState;
</script>

</body>
</html>